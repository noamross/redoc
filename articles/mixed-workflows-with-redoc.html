<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mixed Workflows with redoc • redoc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Mixed Workflows with redoc">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">redoc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/mixed-workflows-with-redoc.html">Usage</a>
</li>
<li>
  <a href="../articles/redoc-package-design.html">Package Design</a>
</li>
<li>
  <a href="../CONTRIBUTING.html">Contributing</a>
</li>
<li>
  <a href="../news/index.html">Release Notes</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
</li>
<li>
  <a href="https://github.com/noamross/redoc">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Mixed Workflows with redoc</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/noamross/redoc/blob/master/vignettes/mixed-workflows-with-redoc.Rmd"><code>vignettes/mixed-workflows-with-redoc.Rmd</code></a></small>
      <div class="hidden name"><code>mixed-workflows-with-redoc.Rmd</code></div>

    </div>

    
    
<p><strong>redoc</strong> is a package to enable a two-way R Markdown-Microsoft Word workflow. It generates Word documents that can be de-rendered back into R Markdown, retaining edits on the Word document, including tracked changes.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the <strong>redoc</strong> package with the <strong>remotes</strong> (or <strong>devtools</strong>) package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"noamross/redoc"</span>)</a></code></pre></div>
<p>Note that <strong>redoc</strong> requires a recent version of Pandoc (&gt;= 2.1.2). If you have RStudio version 1.2 or higher, you should have this by default.</p>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic Usage</h2>
<p><strong>redoc</strong> provides an R Markdown <a href="https://bookdown.org/yihui/rmarkdown/output-formats.html">output format</a>, <code><a href="../reference/redoc.html">redoc()</a></code>, built on top of <code><a href="https://rdrr.io/pkg/rmarkdown/man/word_document.html">rmarkdown::word_document()</a></code>. You will typically call it via the YAML header in your R Markdown document:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb2-1" title="1"><span class="ot">---</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="fu">output:</span><span class="at"> redoc::redoc</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="ot">---</span></a></code></pre></div>
<p><code><a href="../reference/redoc.html">redoc()</a></code> output resembles typical R Markdown Word output, but has some key differences:</p>
<ul>
<li>
<a href="http://criticmarkup.com/spec.php#thebasicsyntax">Critic Markup</a> edits will be converted to Word tracked changes.</li>
<li>By default, parts of the documented generated programmatically will be highlighted. (Change this with <code>highlight_outputs = TRUE</code>)</li>
<li>The original <code>.Rmd</code> and all code is stored internally in Word document for later retrieval.</li>
</ul>
<p>Word files that have been created by <code><a href="../reference/redoc.html">redoc()</a></code> can be reverted to <code>.Rmd</code> with the <code><a href="../reference/dedoc.html">dedoc()</a></code> function, <em>even after they are edited</em>. <code><a href="../reference/dedoc.html">dedoc()</a></code> will return the path of the de-rendered document.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(redoc)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/basename.html">basename</a></span>(<span class="kw"><a href="../reference/redoc_examples.html">redoc_example_docx</a></span>()))</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; [1] "example.docx"</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw"><a href="../reference/dedoc.html">dedoc</a></span>(<span class="kw"><a href="../reference/redoc_examples.html">redoc_example_docx</a></span>())</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; [1] "./example.Rmd"</span></a></code></pre></div>
<p>If the Word document has tracked changes, <code><a href="../reference/dedoc.html">dedoc()</a></code> will, by default, convert these to back to Critic Markup syntax. However, tracked changes are not necessary. You can view the changes between the original R Markdown file and the de-rendered one using the <code><a href="../reference/redoc_diff.html">redoc_diff()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="../reference/redoc_diff.html">redoc_diff</a></span>(<span class="kw"><a href="../reference/redoc_examples.html">redoc_example_edited_docx</a></span>())</a></code></pre></div>
<p><img src="figures/readme-diff.png"></p>
<p>Note that <strong>redoc</strong> tracks changes to parts of the document that are specified in the YAML header - title, subtitle, author, and date.</p>
</div>
<div id="rstudio-integration" class="section level2">
<h2 class="hasAnchor">
<a href="#rstudio-integration" class="anchor"></a>RStudio Integration</h2>
<p><strong>redoc</strong> has three RStudio Addins to simplify workflow when working with R Markdown documents:</p>
<ul>
<li>“Render and Update” renders an R Markdown Document and the updates the text after round-tripping in to Word format and back. This helps with cleaning up small syntax differences. YAML headers, for instance, will use single rather than double quotes, only quote when necessary, and use <code>yes</code> and <code>no</code> instead of <code>TRUE</code> and <code>FALSE</code>. Critic Markup annotations will be separated from adjacent text by a space. Lines will be wrapped to a uniform width. If you round-trip your document this way, you can minimize the changes that result from editing. If you don’t use the Addin, you can retrieve the round-tripped document with <code>redoc_extract_rmd(..., type = 'roundtrip').</code>
</li>
<li>“Dedoc to active file” and “Dedoc to new file” de-render a file and place the contents in RStudio editor tabs, and also display a diff changes in the RStudio viewer.</li>
</ul>
<p>The package also contains a <code>redoc</code> R Markdown template.</p>
</div>
<div id="handling-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#handling-changes" class="anchor"></a>Handling changes</h2>
<p><strong>redoc</strong> attempts to be smart about restoring code in Word documents that have been modified. By default, if the outputs of code blocks move, the code blocks will also move in the de-rendered R Markdown. Note that this can break code if blocks are moved out of order.</p>
<p>If code block outputs are deleted, the original code is restored, but wrapped in HTML comments (<code>&lt;!-- ... --&gt;</code>). Inline code that is deleted is not restored. Defaults of how code is restored can be modified via the <code>block_missing</code> and <code>inline_missing</code> arguments in <code><a href="../reference/dedoc.html">dedoc()</a></code>.</p>
<p>You can also extract the original R Markdown file used to produce a Word document with <code><a href="../reference/redoc_extract_rmd.html">redoc_extract_rmd()</a></code>.</p>
</div>
<div id="additional-features" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-features" class="anchor"></a>Additional Features</h2>
<p>The <code><a href="../reference/redoc.html">redoc()</a></code> format has some additional arguments for formatting Word documents, <code>margins</code> and <code>line_numbers</code>. These can be set in the YAML header to modify your, er, margins and line numbering</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb5-1" title="1"><span class="ot">---</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="fu">output:</span></a>
<a class="sourceLine" id="cb5-3" title="3">  redoc:<span class="fu">:redoc:</span></a>
<a class="sourceLine" id="cb5-4" title="4">    <span class="fu">margins:</span><span class="at"> </span><span class="fl">0.5</span><span class="at"> </span><span class="co">#sets margins to 0.5 inches</span></a>
<a class="sourceLine" id="cb5-5" title="5">    <span class="fu">line_numbers:</span><span class="at"> </span><span class="ch">TRUE</span><span class="at"> </span><span class="co"># adds line numbers to the document</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="ot">---</span></a></code></pre></div>
<p>These can also take more complex lists of values for finer control. These functions may be migrated to <a href="https://github.com/davidgohel/officedown"><strong>officedown</strong></a> at a future time.</p>
</div>
<div id="known-limitations" class="section level2">
<h2 class="hasAnchor">
<a href="#known-limitations" class="anchor"></a>Known Limitations</h2>
<ul>
<li>
<strong>redoc</strong> does not work with <code>.docx</code> files edited with LibreOffice because of differences between Word and LibreOffice files’ internal structure.</li>
<li>Critic Markup comments can not be overlapping or nested. If you convert a word document to markdown and back, comments will be out of place.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#basic-usage">Basic Usage</a></li>
      <li><a href="#rstudio-integration">RStudio Integration</a></li>
      <li><a href="#handling-changes">Handling changes</a></li>
      <li><a href="#additional-features">Additional Features</a></li>
      <li><a href="#known-limitations">Known Limitations</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Noam Ross.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
